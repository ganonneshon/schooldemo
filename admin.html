<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>School Admin Dashboard</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f9f9f9;
    }
    .sidebar {
      width: 250px;
      height: 100vh;
      position: fixed;
      left: 0;
      top: 0;
      background: #1b1f3b;
      color: #fff;
      padding-top: 60px;
    }
    .sidebar a {
      color: #fff;
      text-decoration: none;
      display: block;
      padding: 12px 20px;
      transition: 0.3s;
    }
    .sidebar a:hover {
      background: #3949ab;
    }
    .content {
      margin-left: 250px;
      padding: 20px;
    }
    .logout-btn {
      position: absolute;
      bottom: 20px;
      left: 20px;
      right: 20px;
    }
  </style>
</head>
<body>

  <!-- Sidebar -->
  <div class="sidebar">
    <h4 class="text-center">Admin Panel</h4>
    <a href="#" onclick="showSection('admissions')"><i class="bi bi-person-plus"></i> Admissions</a>
    <a href="#" onclick="showSection('results')"><i class="bi bi-journal-check"></i> Results</a>
    <a href="#" onclick="showSection('routine')"><i class="bi bi-calendar2-week"></i> Routine</a>
    <a href="#" onclick="showSection('downloads')"><i class="bi bi-download"></i> Downloads</a>
    <button class="btn btn-danger w-100 mt-3 logout-btn" onclick="logout()">Logout</button>
  </div>

  <!-- Content -->
  <div class="content">
    <h2 id="section-title">Dashboard</h2>
    <div id="dashboard-section">
      <p>Welcome to the Admin Dashboard! Use the sidebar to manage content.</p>
    </div>

    <!-- Admissions -->
    <div id="admissions" class="d-none">
      <h3>Admissions</h3>
      <form id="admissionForm" class="row g-3">
        <input class="form-control" placeholder="Student Name" id="studentName">
        <input class="form-control" placeholder="Class" id="studentClass">
        <input class="form-control" placeholder="Contact No" id="studentContact">
        <button class="btn btn-primary mt-2" type="submit">Add Admission</button>
      </form>
      <ul id="admissionList" class="list-group mt-3"></ul>
    </div>

    <!-- Results -->
    <div id="results" class="d-none">
      <h3>Results</h3>
      <form id="resultForm" class="row g-3">
        <input class="form-control" placeholder="Roll" id="resultRoll">
        <input class="form-control" placeholder="Class" id="resultClass">
        <input class="form-control" placeholder="GPA" id="resultGPA">
        <button class="btn btn-success mt-2" type="submit">Add Result</button>
      </form>
      <ul id="resultList" class="list-group mt-3"></ul>
    </div>

    <!-- Routine -->
    <div id="routine" class="d-none">
      <h3>Routine</h3>
      <form id="routineForm" class="row g-3">
        <input class="form-control" placeholder="Class" id="routineClass">
        <input class="form-control" placeholder="Day" id="routineDay">
        <input class="form-control" placeholder="Subject" id="routineSubject">
        <button class="btn btn-info mt-2" type="submit">Add Routine</button>
      </form>
      <ul id="routineList" class="list-group mt-3"></ul>
    </div>

    <!-- Downloads -->
    <div id="downloads" class="d-none">
      <h3>Downloads</h3>
      <form id="downloadForm" class="row g-3">
        <input class="form-control" placeholder="Title" id="downloadTitle">
        <input class="form-control" placeholder="File URL" id="downloadUrl">
        <button class="btn btn-warning mt-2" type="submit">Add File</button>
      </form>
      <ul id="downloadList" class="list-group mt-3"></ul>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js"></script>

  <script>
    // ðŸ”¹ Firebase Config (replace with your own)
    const firebaseConfig = {
      apiKey: "YOUR_KEY",
      authDomain: "YOUR_DOMAIN",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_BUCKET",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    // Init Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // Sidebar Navigation
    function showSection(id) {
      document.querySelectorAll('.content > div').forEach(sec => sec.classList.add('d-none'));
      document.getElementById(id).classList.remove('d-none');
      document.getElementById("section-title").innerText = id.charAt(0).toUpperCase() + id.slice(1);
    }

    // Logout
    function logout() {
      auth.signOut().then(() => {
        alert("Logged out!");
        window.location.href = "index.html";
      });
    }

    // ðŸ”¹ Admissions CRUD
    const admissionForm = document.getElementById('admissionForm');
    const admissionList = document.getElementById('admissionList');
    admissionForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      await db.collection('admissions').add({
        name: studentName.value,
        class: studentClass.value,
        contact: studentContact.value
      });
      studentName.value = studentClass.value = studentContact.value = "";
      loadAdmissions();
    });

    async function loadAdmissions() {
      admissionList.innerHTML = "";
      const snapshot = await db.collection('admissions').get();
      snapshot.forEach(doc => {
        admissionList.innerHTML += `<li class="list-group-item d-flex justify-content-between">
          ${doc.data().name} - ${doc.data().class}
          <button class="btn btn-sm btn-danger" onclick="deleteDoc('admissions','${doc.id}')">Delete</button>
        </li>`;
      });
    }

    // ðŸ”¹ Results CRUD
    const resultForm = document.getElementById('resultForm');
    const resultList = document.getElementById('resultList');
    resultForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      await db.collection('results').add({
        roll: resultRoll.value,
        class: resultClass.value,
        gpa: resultGPA.value
      });
      resultRoll.value = resultClass.value = resultGPA.value = "";
      loadResults();
    });

    async function loadResults() {
      resultList.innerHTML = "";
      const snapshot = await db.collection('results').get();
      snapshot.forEach(doc => {
        resultList.innerHTML += `<li class="list-group-item d-flex justify-content-between">
          Roll: ${doc.data().roll} - GPA: ${doc.data().gpa}
          <button class="btn btn-sm btn-danger" onclick="deleteDoc('results','${doc.id}')">Delete</button>
        </li>`;
      });
    }

    // ðŸ”¹ Routine CRUD
    const routineForm = document.getElementById('routineForm');
    const routineList = document.getElementById('routineList');
    routineForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      await db.collection('routine').add({
        class: routineClass.value,
        day: routineDay.value,
        subject: routineSubject.value
      });
      routineClass.value = routineDay.value = routineSubject.value = "";
      loadRoutine();
    });

    async function loadRoutine() {
      routineList.innerHTML = "";
      const snapshot = await db.collection('routine').get();
      snapshot.forEach(doc => {
        routineList.innerHTML += `<li class="list-group-item d-flex justify-content-between">
          ${doc.data().class} - ${doc.data().day} - ${doc.data().subject}
          <button class="btn btn-sm btn-danger" onclick="deleteDoc('routine','${doc.id}')">Delete</button>
        </li>`;
      });
    }

    // ðŸ”¹ Downloads CRUD
    const downloadForm = document.getElementById('downloadForm');
    const downloadList = document.getElementById('downloadList');
    downloadForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      await db.collection('downloads').add({
        title: downloadTitle.value,
        url: downloadUrl.value,
        date: new Date()
      });
      downloadTitle.value = downloadUrl.value = "";
      loadDownloads();
    });

    async function loadDownloads() {
      downloadList.innerHTML = "";
      const snapshot = await db.collection('downloads').get();
      snapshot.forEach(doc => {
        downloadList.innerHTML += `<li class="list-group-item d-flex justify-content-between">
          ${doc.data().title}
          <button class="btn btn-sm btn-danger" onclick="deleteDoc('downloads','${doc.id}')">Delete</button>
        </li>`;
      });
    }

    // ðŸ”¹ Delete Document
    async function deleteDoc(collection, id) {
      await db.collection(collection).doc(id).delete();
      if (collection === 'admissions') loadAdmissions();
      if (collection === 'results') loadResults();
      if (collection === 'routine') loadRoutine();
      if (collection === 'downloads') loadDownloads();
    }

    // Initial Load
    loadAdmissions();
    loadResults();
    loadRoutine();
    loadDownloads();
  </script>
</body>
</html>
